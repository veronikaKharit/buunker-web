import React, { useRef } from 'react';
import { useLocation, useNavigate } from 'react-router-dom';

function Rules() {
  const rulesRef = useRef(null);
  const location = useLocation();
  const navigate = useNavigate();
  const { state } = location;

  const handleBack = () => {
    if (state?.fromGame) {
      navigate(`/game?code=${state.gameCode}&player=${state.playerName}`);
    } else {
      navigate('/');
    }
  };

  const scrollAmount = 100;

  const scrollUp = () => {
    if (rulesRef.current) {
      rulesRef.current.scrollBy({ top: -scrollAmount, behavior: 'smooth' });
    }
  };

  const scrollDown = () => {
    if (rulesRef.current) {
      rulesRef.current.scrollBy({ top: scrollAmount, behavior: 'smooth' });
    }
  };

  return (
    <div className="rules-wrapper">
      {/* Кнопка "Назад" */}
      <button className="back-button" onClick={handleBack} aria-label="Назад">
        ← Назад
      </button>

      <div className="rules-container" ref={rulesRef}>
        <div className="rules-content">
          <h1>Правила игры "Бункер"</h1>
          
          <section>
            <h2>Введение</h2>
            <p>Можете ли вы представить, каково это — пережить глобальную катастрофу? Думаю, что нет... Именно для этого был создан «Бункер Онлайн», чтобы вы могли почувствовать, каково это. Наша игра очень проста, и на изучение правил вам не понадобится много времени! Уже после первой игры вы будете полностью понимать, как играть. Также перед началом игры советуем вам приготовить вкусный чай или кофе, взять печенье и с головой погрузиться в игру!</p>
          </section>

          <section>
            <h2>История</h2>
            <p>На Земле вот-вот произойдёт катастрофа, а может, она уже началась! Я, как и большинство людей, в панике пытаюсь выжить и найти укрытие, чтобы спасти свою жизнь...</p>
            <p>...Тех, кто не попадёт, ждёт верная смерть. Так началась моя история выживания...</p>
          </section>

          <section>
            <h2>Обзор</h2>

            <h3>Катаклизм</h3>
            <p>Описание текущего для игры катаклизма. Как это произошло, что случилось и чёткое понимание того, с чем связаны проблемы, что даст вам понять в процессе игры, кто из людей вам подходит, а кого нужно выгнать (см. Катастрофы).</p>

            <h3>Бункер</h3>
            <p>Описание найденного бункера. Единственный шанс выжить в случае катаклизма — попасть в бункер. У вас есть информация о времени его постройки, местонахождении и данные о спальных комнатах.</p>
            <ul>
              <li>Размер бункера — общая площадь убежища.</li>
              <li>Время нахождения — сколько времени вам потребуется, чтобы пережить катастрофу.</li>
              <li>Количество еды — запас продуктов, которого хватит на время пребывания.</li>
              <li>В бункере есть — вещи, полезные для выживания.</li>
            </ul>
            <p>В зависимости от содержимого бункера вам предстоит определить, кто из выживших будет более полезен (см. Информацию о бункере).</p>

            <h3>Описание персонажа</h3>
            <p>Ваш герой обладает следующими характеристиками:</p>
            <ul>
              <li>Пол</li>
              <li>Телосложение</li>
              <li>Человеческая черта</li>
              <li>Профессия</li>
              <li>Здоровье</li>
              <li>Хобби / Увлечение</li>
              <li>Фобия / Страх</li>
              <li>Крупный инвентарь</li>
              <li>Рюкзак</li>
              <li>Дополнительное сведение</li>
              <li>Спец. возможность</li>
            </ul>

            <h3>Заметки</h3>
            <p>Место для заметок, которые можно делать во время игры.</p>

            <h3>Панель ведущего</h3>
            <p>Набор функций для использования специальных возможностей игроков и управления лагерем и таймером.</p>
          </section>

          <section>
            <h2>Процесс игры</h2>
            <p>В первом игровом раунде все начинается с представления друг другу (см. Раунд игры)...</p>
            <p>...В конце игры игроки, попавшие в бункер, раскрывают свои характеристики. Ведущий подводит итог (см. «Победа в игре»).</p>
          </section>

          <section>
            <h2>Количество игроков</h2>
            <h3>Характеристики для открытия</h3>
            <table>
              <thead>
                <tr>
                  <th>Игроки</th>
                  <th>1-й раунд</th>
                  <th>2-й раунд</th>
                  <th>3-й раунд</th>
                  <th>С 4-го по 7-й</th>
                </tr>
              </thead>
              <tbody>
                <tr><td>6</td><td>3</td><td>3</td><td>2</td><td>—</td></tr>
                <tr><td>7-8</td><td>3</td><td>3</td><td>1</td><td>по 1</td></tr>
                <tr><td>9-10</td><td>3</td><td>2</td><td>1</td><td>по 1</td></tr>
                <tr><td>11-12</td><td>2</td><td>2</td><td>1</td><td>по 1</td></tr>
                <tr><td>13-15</td><td>2</td><td>1</td><td>1</td><td>по 1</td></tr>
              </tbody>
            </table>

            <h3>Мест в бункере</h3>
            <table>
              <thead>
                <tr>
                  <th>Выживших</th>
                  <th>6-7</th>
                  <th>8-9</th>
                  <th>10-11</th>
                  <th>12-13</th>
                  <th>14-15</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Мест в бункере</td>
                  <td>3</td><td>4</td><td>5</td><td>6</td><td>7</td>
                </tr>
              </tbody>
            </table>
          </section>

          <section>
            <h2>Раунд игры</h2>
            <p>Первый раунд игроки начинают по часовой стрелке, начиная с первого игрока, который нашёл бункер...</p>
          </section>

          <section>
            <h2>Ваш ход</h2>
            <p>Ваш ход — самое время блеснуть! Расскажите свою историю ярко и эмоционально...</p>
          </section>

          <section>
            <h2>Коллективное обсуждение</h2>
            <p>Общее обсуждение длится 1 минуту. Каждый может высказаться.</p>
          </section>

          <section>
            <h2>Голосование</h2>
            <h3>Основные правила</h3>
            <p>Голосование за исключение игрока из временного лагеря проводит ведущий.</p>

            <h3>Пропуск голосования</h3>
            <p>Пропускать голосование можно только в первом раунде...</p>

            <h3>Проведение голосования</h3>
            <p>Каждому игроку даётся 30 секунд на высказывание перед голосованием...</p>

            <h3>Результаты голосования</h3>
            <ul>
              <li>Игрок с 70% и более голосов — исключается без объяснений.</li>
              <li>Игрок с наибольшим числом голосов менее 70% — 30 секунд на оправдание.</li>
              <li>Равенство голосов — дополнительные объяснения и повторное голосование.</li>
            </ul>

            <h3>Завершение голосования</h3>
            <p>После голосования игроки, покидающие лагерь, произносят прощальную речь...</p>
          </section>

          <section>
            <h2>Победа в игре</h2>
            <p>Игра завершается, когда необходимое количество игроков попало в бункер...</p>
          </section>

          <section>
            <h2>Важно!</h2>
            <p>Данный свод правил относится к основному (базовому) паку. Правила расширенных паков могут отличаться.</p>
          </section>
        </div>
      </div>
      
      <div>
        <div className="scroll-buttons">
          <button onClick={scrollUp} aria-label="Прокрутить вверх">↑</button>
          <button onClick={scrollDown} aria-label="Прокрутить вниз">↓</button>
        </div>
      </div>
    </div>
  );
}

export default Rules;